name: "CodeQL Security Scanning Configuration"

# Exclude tools directory from CodeQL scanning
# Rationale: Tools are diagnostic scripts for local network cable modems that use
# self-signed certificates. Same security reasoning as documented in const.py:
# 1. Cable modems universally use self-signed certificates (no CA-signed option)
# 2. Target environment is private LANs (192.168.x.x, 10.0.x.x)
# 3. MITM risk acceptable in private network context
# 4. Self-signed cert still provides encryption in transit
# 5. These are diagnostic utilities, not production code
paths-ignore:
  - "tools/**"
  - "scripts/**"
  - "docs/**"
  - "tests/parsers/**/fixtures/**"

# Additional query packs for comprehensive security scanning
packs:
  - codeql/python-queries:AlertSuppression.ql
  - codeql/python-queries:Security
  - codeql/python-queries:Correctness

# Custom queries specific to this integration
queries:
  - name: Cable Modem Security Queries
    uses: ./.github/codeql/queries/cable-modem-security.qls

# Query filters to reduce false positives
query-filters:
  - exclude:
      id: py/clear-text-logging-sensitive-data
      # Rationale: Cable modem diagnostics intentionally log configuration
      # for troubleshooting. Data is local to Home Assistant instance.
  - exclude:
      id: py/clear-text-storage-sensitive-data
      # Rationale: Home Assistant handles credential encryption.
      # Integration uses HA's built-in secure storage.

# Enable all security-related query metadata
# This ensures comprehensive coverage of CWE categories
disable-default-queries: false

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<!--<META name="description" content='C3700-100NAS'>-->
<META name="description" content='123'>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<META http-equiv="Content-Style-Type" content="text/css">
<META http-equiv="Pragma" content="no-cache">
<META HTTP-equiv="Cache-Control" content="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT">

<title>NETGEAR Gateway C3700-100NAS</title>
<link rel="stylesheet" href="css/table.css">
<link rel="stylesheet" href="css/scrollbar.css">
<link rel="stylesheet" href="css/button.css">

<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="script/jquery.mousewheel.js"></script>
<script type="text/javascript" src="script/jquery.jscrollpane.min.js"></script>

<script type="text/javascript" src="script/script.js"></script>
<link rel="stylesheet" href="form.css">
<!--style type="text/javascript">
    classes.num.all.fontFamily = "Courier";
    classes.num.all.fontSize = "10pt" ;
</style-->
<script type="text/javascript" src="func.js"></script>
<script type="text/javascript" src="msg.js"></script>
<script type="text/javascript" src="utility.js"></script>
<script type="text/javascript" src="browser.js"></script>
<script type="text/javascript" src="md5.js"></script>
<script type="text/javascript" src="wep.js"></script>

<script type="text/javascript">
    var childWindow = null;
//<![CDATA[
    $(document).ready(function()
    {
//        if(need_to_check_browser_type())
//            window.location.href="USBAdv.htm";

        BodyInit();

//        $('.scroll-pane').jScrollPane('scrollbarMargin:5px');
        $("#target").submit(function() {
            buttonFilter();
        });

    });


    function setHelpIframeVisible(){
        $('.help-frame-div').css("visibility","visible");
    }


    function showHelpIframe() {


        var imgSrc=document.getElementById('help-button');

        if(imgSrc.src.search("up")>=0)
        {
            $(".help-frame-div").show();
            imgSrc.src="img/helparrowdown-icon.gif";
        }
        else
        {
            $(".help-frame-div").hide();
            imgSrc.src="img/helparrowup-icon.gif";
            setTimeout(setHelpIframeVisible,500);
        }
    }
    function moveToHTMLend()
    {
        window.location.href='#helpframe-anchor';
        setHelpIframeVisible();
    }


    function loadhelp(fname,anchname)
    {
                var pane = window.frames["helpframe"].$('#content');
                var imgSrc=document.getElementById('help-button');
                if(imgSrc.src.search("up")<0)
                {

                        $(".help-frame-div").show();
                        pane.jScrollPane({showArrows:true});


                        if ((loadhelp.arguments.length == 1 ) || (anchname == "" ))
                        {
                                window.frames["helpframe"].location.href=fname+"_h."+"htm";
                                $(".help-frame-div").show();
                        }
                        else
                        {
                                window.frames["helpframe"].location.href=fname+"_h."+"htm#" + anchname;
                                $(".help-frame-div").show();
                        }

                        $(".help-frame-div").show();
                        pane.jScrollPane({showArrows:true});

                }
    }

function need_to_check_browser_type()
{
    var isIE = navigator.userAgent.search("MSIE") > -1;
    var isFirefox = navigator.userAgent.search("Firefox") > -1;
    var isOpera = navigator.userAgent.search("Opera") > -1;
    var isChrome = navigator.userAgent.search("Chrome") > -1;
    var isSafari = navigator.userAgent.search("Safari") > -1;
    var router_smb_link_style = document.getElementsByName('router_smb_link_style');

    if(isChrome & router_smb_link_style[0].value!="others")
        return true;
    else if(!isChrome & isSafari & router_smb_link_style[0].value!="safari")
        return true;
    else if(isIE & router_smb_link_style[0].value!="explorer")
        return true;
    else if(!isSafari & !isIE & router_smb_link_style[0].value!="others")
        return true;
    else
        return false;
}

function remove_disk()
{
    var msg = ""
    cf=document.forms[0];

    if(cf.usb_num.value == 0)
    {
        msg+= "No Disk.\n";
    }
	else if(cf.usb_num.value > 1)
	{
		openWarnWindow();
		return false;
	}

    if (msg.length > 1)
    {
        alert(msg);
        return false;
    }
    return true;
}

function edit_folder()
{
    cf = document.forms[0];
    if(cf.no_usb_device.value == 1)
    {
        alert("No Disk.");
        return false;
    }
    if(cf.select.value == -1)
    {
        alert("Please choose a Folder.");
        return false;
    }
    cf.action.value = "edit";
    //buttonFilter();
//document.forms[0].submit();
adv_folder(2);
}

function delete_folder()
{
    cf=document.forms[0];
    if(cf.no_usb_device.value == 1)
    {
        alert("No Disk.");
        return false;
    }
    if(cf.select.value == -1)
    {
        alert("Please choose a Folder.\n");
        return false;
    }

    /* There exist folder is "admin" privilege but no "All - no password" privilege. */
    var folderElements = document.getElementsByTagName("input");
    var i;
    var checkAdminFolder = 1, folderNum=0;
    for(i=0;i<folderElements.length;i++)
    {
        if(folderElements[i].type=='hidden')
        {
            if(folderElements[i].id=="USB_NO_PASSWD" || folderElements[i].id=="USB_ADMIN")
            {
                folderNum = folderElements[i].value+1;
                if(folderElements[i].id=="USB_NO_PASSWD" && folderElements[i].value!=cf.select.value)
                {
                    checkAdminFolder = 0;
                    break;
                }
            }
        }
    }

    if ( cf.no_dlna.value != 1 )  {
        if(checkAdminFolder==1 && folderNum>1)
            alert('Notice : To share your files via DLNA/UPnP AV using the Media Server function, at least one shared folders must be Read Access with "All - no password"');
    }
    return true;
}

function checkData()
{
    var cf=document.forms[0];
    var space_flag=0;
    var msg = "";
    var dev_name=cf.deviceName.value;

    msg+= checkBlank(cf.deviceName, "deviceName");
    msg+= checkBlank(cf.workGroup, "workGroup");
    if (msg.length > 1)
    {
        alert(msg);
        return false;
    }
    if (   (cf.deviceName.value.match( /[\x21-\x2C]/ ))
        || (cf.deviceName.value.match( /[\x2E-\x2F]/ ))
        || (cf.deviceName.value.match( /[\x3A-\x40]/ ))
        || (cf.deviceName.value.match( /[\x5B-\x60]/ ))
        || (cf.deviceName.value.match( /[\x7B-\x80]/ ))
        || (cf.deviceName.value.match( /[^\x21-\x7E]/ ))
       )
    {
        alert("Invalid device name.\n");
        return false;
    }

    if(cf.workGroup.value == ""){
        alert("Invalid Workgroup Name.\n");
        return false;
    }
    if (cf.workGroup.value.match( /[^\x20-\x7E]/ ))
    {
        cf.workGroup.focus();
        alert("Invalid Workgroup Name.\n");
        return false;
    }

    var portvalue=parseInt(cf.http_via_port.value);
    if( (isNaN(portvalue) || portvalue < 80 || (portvalue > 80 && portvalue < 1024) || portvalue > 65535 ) && portvalue!=443)
    {
        alert("http via port should be 443 or in the range [1024 ~ 65535] .");
        return false;
    } else if ( (cf.is_https.value == "0") && (portvalue == 443) ) {
        alert("http via port should be 443 or in the range [1024 ~ 65535] .");
                return false;
        }

    portvalue=parseInt(cf.ftp_via_port.value);
    if( isNaN(portvalue) || portvalue < 21 || (portvalue > 21 & portvalue < 1024) || portvalue > 65535)
    {
        alert("ftp via port should be 21 or in the range [1024 ~ 65535] .");
        return false;
    }
    if (cf.ftp_via_port.value == cf.http_via_port.value)
    {
        alert("HTTP port (via Internet) should not be the same as FTP port (via Internet).");
        return false;
    }



    buttonFilter();
document.forms[0].submit();
    return true;
}

function chgSel(index)
{
 document.forms[0].select.value = index;
 return true;
}

function loadSettings()
{
    var cf=document.forms[0];
    var adv_add_edit_page = cf.add_edit_page.value;
    if (cf.no_usb_device.value == 1)
    {
        var removeButton;
        cf.Remove.disabled = 'true';
        removeButton=document.getElementsByName("Remove");
        removeButton[0].outerHTML='<button type="submit" disabled="disabled" value="Safely Remove USB Device" name="Remove" class="button-grey" onClick="buttonClick(this,\'Safely Remove USB Device\');return remove_disk();"><span class="roundleft_grey">&nbsp;&nbsp; Safely Remove USB Device<\/span><span class="roundright_grey">&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/button>';
        removeButton[0].style.cursor='default';
    }

    // Chuck 20150511 Don't show adv folder page automatically to prevent it is blocked as ads.

    if (cf.enable_apmode.value == "1") {
        cf.enable_wan_http.disabled=true;
        cf.http_via_port.disabled=true;
        cf.enable_wan_ftp.disabled=true;
        cf.ftp_via_port.disabled=true;
    } else {
        cf.enable_wan_http.disabled=false;
        cf.http_via_port.disabled=false;
        cf.enable_wan_ftp.disabled=false;
        cf.ftp_via_port.disabled=false;
    }
}

function adv_folder(index)
{
	if (index == "2") // edit folder
    {
        // Chuck 20140902 fix mantis#12486
        if(isUnsupportedMobileBrowser())
        {
            top.$.blockUI({
                message: '<iframe width="500px" height="550px" src="USBAdvEdit.htm?folderIdx=' + document.forms[0].folderIdx.value + '&UUID=' + document.forms[0].UUID.value + '"></iframe>',
                css: {width: '100%', height: '0px', top: '0px', left: '0px', border: '0px', backgroundColor: 'transparent'},
                onOverlayClick: closeIframe
            });
        }
        else
        {
            childWindow = window.open('USBAdvEdit.htm?folderIdx=' + document.forms[0].folderIdx.value + '&UUID=' + document.forms[0].UUID.value,'net_folder','resizable=0,scrollbars=no,width=500,height=450,left=400,top=300');
            childWindow.focus();
            showDisablePage(parent.document.getElementById("diablePage"),childWindow,parent.document.getElementById("all").offsetWidth,parent.document.getElementById("all").offsetHeight);

            // Chuck 20140902 fix mantis#12486
            // Chuck 20150203 Fix TD#328: C7000-100NAS: User Interface -- GUI is stuck when closing "connection status" page quickly.
            //if(!isOnBeforeUnloadSupported())
            {
                detectPoppedWindowStatus();
            }
        }
    }
    else if (index == "1") // add folder
    {
        // Chuck 20140902 fix mantis#12486
        if(isUnsupportedMobileBrowser())
        {
            top.$.blockUI({
                message: '<iframe width="500px" height="550px" src="USBAdvAdd.htm"></iframe>',
                css: {width: '100%', height: '0px', top: '0px', left: '0px', border: '0px', backgroundColor: 'transparent'},
                onOverlayClick: closeIframe
            });
        }
        else
        {
            childWindow = window.open('USBAdvAdd.htm','net_folder','resizable=0,scrollbars=no,width=500,height=450,left=400,top=300');
            childWindow.focus();
            showDisablePage(parent.document.getElementById("diablePage"),childWindow,parent.document.getElementById("all").offsetWidth,parent.document.getElementById("all").offsetHeight);

            // Chuck 20140902 fix mantis#12486
            // Chuck 20150203 Fix TD#328: C7000-100NAS: User Interface -- GUI is stuck when closing "connection status" page quickly.
            //if(!isOnBeforeUnloadSupported())
            {
                detectPoppedWindowStatus();
            }
        }
    }
}

// Chuck 20140902 fix mantis#12486
// We will use polling instead of onBeforeUnload in following browsers
// PC: Opera with Presto,
// iPad: Safari,
// iPhone: Opera
// Android Pad: Opera, Chrome(restoring delayed about 3 secs?), Firefox
// Android Phone:
function isOnBeforeUnloadSupported()
{
    if(navigator.userAgent.indexOf("Presto") > -1
        || navigator.userAgent.indexOf("iPad") > -1
        || navigator.userAgent.indexOf("iPhone") > -1
        || navigator.userAgent.indexOf("Android") > -1
        )
    {
        return false;
    }

    return true;
}

// Chuck 20140902 fix mantis#12486
// Because the following browser can't handle the window opened by itself, we will use BlockUI instead of polling or onBeforeUnload to prevent user clicking the GUI when a statistic/connection status window is opening.
// PC:
// iPad: Opera Mini,
// iPhone:
// Android Pad: Dolphin Mini, UC, Safari, Native
// Android Phone:
function isUnsupportedMobileBrowser()
{
    /* Examples:
     * iPad-Safari: Mozilla/5.0 (iPad; CPU OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D201 Safari/9537.53
     * iPad-Opera: Mozilla/5.0 (iPad; CPU OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) OPiOS/8.0.2.80660 Mobile/11D201 Safari/9537.53
     * iPad-Chrome: Mozilla/5.0 (iPad; CPU OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) CriOS/36.0.1985.57 Mobile/11D201 Safari/9537.53 (000514)
     * Android-Native: Mozilla/5.0 (Linux; U; Android 4.1.2; zh-tw; GT-N8010 Build/JZO54K) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30
     * Android-Opera: Mozilla/5.0 (Linux; U; Android 4.1.2; zh-tw; GT-N8010 Build/JZO54K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.138 Safari/537.36 OPR/22.0.1485.81203
     * Android-Chrome: Mozilla/5.0 (Linux; U; Android 4.1.2; zh-tw; GT-N8010 Build/JZO54K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1958.135 Safari/537.36
     * PC-IE: Mozilla/5.0 (Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E; rv:11.0) like Gecko
     * PC-Opera: Opera/9.80 (Windows NT 6.1; U; zh-tw) Presto/2.10.289 Version/12.00
     * PC-Chrome: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.102 Safari/537.36
     */
    var firstSupportedWebKit = "AppleWebKit/535";
    if(navigator.userAgent.indexOf("iPad") == -1
        && navigator.userAgent.indexOf("iPhone") == -1
        && navigator.userAgent.indexOf("Android") == -1
        )
    {
        // Is PC browser.
        return false;
    }
    else if(navigator.userAgent.indexOf("OPiOS") > -1)
    {
        // Although the AppleWebKit version of Opera on iOS is greater than 534, but it still can't handle the opened window.
        return true;
    }
    else if(navigator.userAgent.indexOf("AppleWebKit/") > -1
        && navigator.userAgent.substring(navigator.userAgent.indexOf("AppleWebKit/")) < firstSupportedWebKit)
    {
        // The browser using the lower version (<=534) of AppleWebKit can't handle the window opened by itself.
        return true;
    }

    return false;
}

// Chuck 20140902 fix mantis#12486
var intervalId;
function detectPoppedWindowStatus()
{
    intervalId = setInterval(reloadPage, 200);
}

/*--Not refresh the parent page when reloading sub pages--*/
function setTimer()
{
    setTimeout(reloadPage,300);
}
function reloadPage()
{
    if(childWindow.closed)
    {
        parent.document.getElementById("diablePage").style.display = "none";
		window.location.reload();

        // Chuck 20140902 fix mantis#12486
        // Chuck 20150203 Fix TD#328: C7000-100NAS: User Interface -- GUI is stuck when closing "connection status" page quickly.
        //if(!isOnBeforeUnloadSupported())
        {
            clearInterval(intervalId);
        }
    }
}

// Chuck 20140902 fix mantis#12486
function closeIframe()
{
    top.$.unblockUI();
    window.location.reload();
}
/*--End--*/
var trWarnWinVar = null;

function openTrWarnWin(filename,win_type)
{
    //trWarnWinVar = window.open(filename,'trwarn_win',win_type);
    // Chuck 20140902 fix mantis#12486
    if(isUnsupportedMobileBrowser())
    {
        top.$.blockUI({
            message: '<iframe width="500px" height="550px" src="USBUmount.htm"></iframe>',
            css: {width: '100%', height: '0px', top: '0px', left: '0px', border: '0px', backgroundColor: 'transparent'},
            onOverlayClick: closeIframe
        });
    }
    else
    {
        childWindow = window.open(filename,'trwarn_win',win_type);
        childWindow.focus();
        showDisablePage(parent.document.getElementById("diablePage"),childWindow,parent.document.getElementById("all").offsetWidth,parent.document.getElementById("all").offsetHeight);

        // Chuck 20140902 fix mantis#12486
        // Chuck 20150203 Fix TD#328: C7000-100NAS: User Interface -- GUI is stuck when closing "connection status" page quickly.
        //if(!isOnBeforeUnloadSupported())
        {
            detectPoppedWindowStatus();
        }
    }
}

function openWarnWindow()
{
    var winoptions;

    winoptions = "width=400,height=380,status=yes,resizable=no";
    openTrWarnWin('USBUmount.htm',winoptions);
}
function creat_folder()
{
    var cf=document.forms[0];
    if(cf.no_usb_device.value == 1)
    {
        alert("No Disk.\n");
        return false;
    }
    if(cf.sharefolderNum.value >= 256)
    {
        alert("The number of shared folder has reached the maximum.");
        return false;
    }
    cf.action.value = "add";
    //buttonFilter();
//document.forms[0].submit();
adv_folder(1);
}
// Nick Implement ASP Tag display on GUI
var Lnxip;
var IsLanIp;
var SambaName;

function chgUsbInfo(folderIdx, uuid )
{
 document.forms[0].folderIdx.value = folderIdx;
 document.forms[0].UUID.value = uuid;
 return true;
}

function InitTagValue()
{

//    var tagValueList = "0|0|1|0|***WIFI_CRED***|***WIFI_CRED***|0|0|1|1|1|0|***PRIVATE_IP***|443|21||***PRIVATE_IP***";
    var tagValueList = '0|1|0|0|***WIFI_CRED***|***WIFI_CRED***|1|1|0|0|0|1|***PUBLIC_IP***|443|21|***PRIVATE_IP***|1|0|0|1|0|1|';

    return tagValueList.split("|");
}

function InitUpdateView(tagValues)
{
    IsLanIp = tagValues[16];
    SambaName = tagValues[4];

    // Click Add/Edit web page
    document.getElementsByName("add_edit_page")[0].value = tagValues[0];

    // No USB device
    document.getElementsByName("no_usb_device")[0].value = tagValues[1];

    // USB device Number: ***REDACTED*** = tagValues[2];

    // USB Umount success
    // 0: no need umount
    // 1: successlly umount usb device
    // 2: umount all device
    document.getElementsByName("umountsucc")[0].value = tagValues[3];

    // Device name
    document.getElementsByName("deviceName")[0].value = tagValues[4];
    document.getElementsByName("workGroup")[0].value = piplineDecode(tagValues[5]);

    // Samba
    document.getElementsByName("enable_samba")[0].checked = (tagValues[6] == 1)? true : false;
    // Http
    document.getElementsByName("enable_http")[0].checked = (tagValues[7] == 1)? true : false;
    // WAN Http
    document.getElementsByName("enable_wan_http")[0].checked = (tagValues[8] == 1)? true : false;
    // Ftp
    document.getElementsByName("enable_ftp")[0].checked = (tagValues[9] == 1)? true : false;
    // WAN Ftp
    document.getElementsByName("enable_wan_ftp")[0].checked = (tagValues[10] == 1)? true : false;


    // DLNA
    document.getElementsByName("no_dlna")[0].value = tagValues[11];

    // SMB
//    document.getElementById("smbId").innerHTML = "\\\\" + tagValues[4];

    if(IsLanIp == "1")
    {
        if (navigator.appVersion.indexOf("MSIE") != -1 && (navigator.appVersion.indexOf("Win")!=-1)
            && navigator.userAgent.indexOf("MSIE 11.0") == -1)
        {
    //        alert("IE");
            document.getElementById("smbId").href = "file://" + tagValues[4] + "/";
            document.getElementById("smbId").innerHTML = "\\\\" + tagValues[4];
        }
        else if ((navigator.userAgent.toString().toLowerCase().indexOf("safari") != -1)
            && (navigator.userAgent.toString().toLowerCase().indexOf("chrome") == -1))
    //        &&  (navigator.userAgent.toString().toLowerCase().indexOf("mac")!=-1))
        {
    //        alert ("safari for mac");
            document.getElementById("smbId").href = "smb://" + tagValues[15] + "/";
            document.getElementById("smbId").innerHTML = "\\\\" + tagValues[4] ;
        }
        else if((navigator.userAgent.indexOf("MSIE 11.0") != -1)
             || (navigator.userAgent.toString().toLowerCase().indexOf("chrome") != -1)
             || (navigator.userAgent.toString().toLowerCase().indexOf("mozilla") != -1))
        {
            document.getElementById("smbId").innerHTML = "\\\\" + tagValues[4];
            document.getElementById("smbId").removeAttribute("style");
        }
    /*
        else if ((navigator.appVersion.indexOf("Linux")!=-1) || (navigator.appVersion.indexOf("X11")!=-1))
        {
            alert ("LINUX another");
        }
    */
        else
        {
    //        alert ("another");
            document.getElementById("smbId").removeAttribute("style");
            document.getElementById("smbId").innerHTML = "\\\\" + tagValues[4];
        }
    }
    else
    {
        document.getElementById("smbId").removeAttribute("style");
        document.getElementById("smbId").innerHTML = "\\\\" + tagValues[4];
    }

    if(IsLanIp == "1")
    {
    // HTTP
    document.getElementById("httpId").href = "http://" + tagValues[4] + ".routerlogin.net/shares";
    document.getElementById("httpId").innerHTML = "http://" + tagValues[4] + ".routerlogin.net/shares";

    // HTTP via WAN
    document.getElementById("httpsId").removeAttribute("style");
       if(tagValues[13] == 443)
       {
        document.getElementById("httpsId").innerHTML = "https://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + "/shares";
       }
       else
       {
        document.getElementById("httpsId").innerHTML = "https://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + ":" + tagValues[13] + "/shares";
       }
    document.getElementsByName("http_via_port")[0].value = tagValues[13];

    // FTP
    document.getElementById("ftpId").href = "ftp://" + tagValues[4] + ".routerlogin.net/shares";
    document.getElementById("ftpId").innerHTML = "ftp://" + tagValues[4] + ".routerlogin.net/shares";

    // FTP via WAN
    document.getElementById("ftpViaWan").removeAttribute("style");
       if (tagValues[14] == 21)
       {
           document.getElementById("ftpViaWan").innerHTML = "ftp://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + "/shares";
       }
       else
       {
           document.getElementById("ftpViaWan").innerHTML = "ftp://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + ":" + tagValues[14] + "/shares";
       }
    }
    else
    {
       // HTTP
       document.getElementById("httpId").removeAttribute("style");
       document.getElementById("httpId").innerHTML = "http://" + tagValues[4] + ".routerlogin.net/shares";

       // HTTP via WAN
       document.getElementById("httpsId").href = "https://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + ":" + tagValues[13] + "/shares";
       document.getElementById("httpsId").innerHTML = "https://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + ":" + tagValues[13] + "/shares";
       document.getElementsByName("http_via_port")[0].value = tagValues[13];

       // FTP
       document.getElementById("ftpId").removeAttribute("style");
       document.getElementById("ftpId").innerHTML = "ftp://" + tagValues[4] + ".routerlogin.net/shares";

       // FTP via WAN
       if (tagValues[13] == 21)
       {
           document.getElementById("ftpViaWan").href = "ftp://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + "/shares";
           document.getElementById("ftpViaWan").innerHTML = "ftp://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + "/shares";
       }
       else
       {
          document.getElementById("ftpViaWan").href = "ftp://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + ":" + tagValues[14] + "/shares";
          document.getElementById("ftpViaWan").innerHTML = "ftp://" + encodeHtmlEntities(piplineDecode(tagValues[12])) + ":" + tagValues[14] + "/shares";
       }
    }
    document.getElementsByName("ftp_via_port")[0].value = tagValues[14];

    Lnxip = tagValues[15];

    // Samba Protection
    document.getElementsByName("enable_samba_protect")[0].checked = (tagValues[17] == 1)? true : false;

    // HTTP Protection
    document.getElementsByName("enable_http_protect")[0].checked = (tagValues[18] == 1)? true : false;

    // Remote HTTP Protection
    document.getElementsByName("enable_wan_http_protect")[0].checked = (tagValues[19] == 1)? true : false;

    // FTP Protection
    document.getElementsByName("enable_ftp_protect")[0].checked = (tagValues[20] == 1)? true : false;

    // Remote FTP Protection
    document.getElementsByName("enable_wan_ftp_protect")[0].checked = (tagValues[21] == 1)? true : false;
}

function InitUpdateUSBAdvTableTagView()
{
/*
  Share Name) | Read Access | Write Access
  Folder Name | Volume Name | Total Space | Free Space | FolderIndex | UUID
*/
    var tagValueList = '0|';
/*
    var tagValueList = "3" +
                            "|1|FolderA | N/A | N/A | N/A | N/A | N/A | N/A" +
                            "|2|FolderB | N/A | N/A | N/A | N/A | N/A | N/A" +
                            "|3|FolderC | N/A | N/A | N/A | N/A | N/A | N/A";
*/
    return tagValueList.split("|");
}

function onAddUSBAvailableRowCB(newRow, rowId, firstCellIdx, tags)
{
    var cellsArray = new Array();
    cellsArray [0] = "<input type='radio' name='SelIdx' value='" + rowId + "'" +
            " onclick='chgSel(&#39;" + rowId + "&#39;);" +
            " chgUsbInfo(&#39;" + tags[firstCellIdx + 8] + "&#39;, &#39;" + tags[firstCellIdx + 9] + "&#39;)' />";

    if(IsLanIp == "1")
    {

        if (navigator.appVersion.indexOf("MSIE") != -1 && (navigator.appVersion.indexOf("Win")!=-1))
        {
        //        alert("IE");
            cellsArray [1] = "<a target='_blank' href='file:" + tags[firstCellIdx + 0]+ "' style='text-decoration:underline;color:#0000ff'>"+  tags[firstCellIdx + 0]+ "<\/a>";
        }
        else if ((navigator.userAgent.toString().toLowerCase().indexOf("safari") != -1)
            && (navigator.userAgent.toString().toLowerCase().indexOf("chrome") == -1)
            )
        //        &&  (navigator.userAgent.toString().toLowerCase().indexOf("mac")!=-1))
        {
        //        alert ("safari for mac");
            var shareName=tags[firstCellIdx + 0].replace("\\\\", "");
            shareName = shareName.replace(/\\/g, "/");
            //while (shareName.search("\\") != -1)
            //{
                //shareName = shareName.replace("\\", "/");
            //}
            shareName = shareName.replace(SambaName, "");  //remove "Samba Name" (ex: from "readyshare/USB_Storage" to "/USB_Storage")
            cellsArray [1] = "<a target='_blank' href='smb://" + Lnxip +  shareName
                + "' style='text-decoration:underline;color:#0000ff'>"+ tags[firstCellIdx + 0] + "<\/a>";
        }
        else
        {
        //        alert ("another");
            cellsArray [1] = "&nbsp;" + tags[firstCellIdx + 0] + "&nbsp;";
        }
    }
    else
    {
    cellsArray [1] = "&nbsp;" + tags[firstCellIdx + 0] + "&nbsp;";
    }

    // Nick 20120315, no hyper link when share name is NOT shared
    if(tags[firstCellIdx + 0] == "Not Shared")
    {
        cellsArray [1] = "&nbsp;" + tags[firstCellIdx + 0] + "&nbsp;";
    }

//    cellsArray [1] = "&nbsp;" + tags[firstCellIdx + 0] + "&nbsp;";
    cellsArray [2] = "&nbsp;" + tags[firstCellIdx + 1] + "&nbsp;";
    cellsArray [3] = "&nbsp;" + tags[firstCellIdx + 2] + "&nbsp;";
    cellsArray [4] = "&nbsp;" + tags[firstCellIdx + 3] + "&nbsp;";
    cellsArray [5] = "&nbsp;" + tags[firstCellIdx + 4] + "&nbsp;";
    cellsArray [6] = "&nbsp;" + tags[firstCellIdx + 5] + "&nbsp;";
    cellsArray [7] = "&nbsp;" + tags[firstCellIdx + 6] + "&nbsp;";

    return cellsArray;
}

function InitUpdateUSBAdvTableView(tagValues)
{
    /* draw table and insert content value */
    drawTable('AvailableFoldersTable', tagValues, onAddUSBAvailableRowCB);
}

function drawTable(tableId, tags, onAddRowCB)
{
    var cellsNum = 0;
    var item = 0;
    var totalTagNum = tags.length - 1; // expect the first 1
    var theTable = document.getElementById(tableId);

    var tableStatus = [];

    if ( !tags[tags.length - 1])
        totalTagNum --;
    cellsNum = totalTagNum /  parseInt(tags[0]);

    for(i=0; i<parseInt(tags[0]); i++)
    {
        if(i==0)
        {
            tableStatus[i] = i;
        }
        else
        {
            if(tags[i*cellsNum+5] == tags[(i-1)*cellsNum+5])
            {
                tableStatus[i] = tableStatus[i-1];
            }
            else
            {
                tableStatus[i] = i;
            }
        }
    }

    if (theTable != null)
    {
        // Terry 20111228, remove all table content before to fill out the new content
        while (theTable.rows.length > 1)
        {
            theTable.deleteRow(theTable.rows.length - 1);
        }
        //

        for (item = 0; item < parseInt(tags[0]); item++)
        {
            var newRow = theTable.insertRow(-1);
            var cellsList = onAddRowCB(newRow, item , (item * cellsNum) + 1, tags);

            for (i = 0; i < cellsList.length; i++)
            {
                if (cellsList[i].length == 0)
                {
                    newRow.insertCell(-1).innerHTML = '&nbsp;';
                }
                else
                {
                    if(i==5 || i==6 || i==7)
                    {
                        if(tableStatus[item] != tableStatus[item-1])
                        {
                            var k;
                            var spanNumber = 0;
                            for(k=0;k<tableStatus.length;k++)
                            {
                                if(tableStatus[k]==item)
                                {
                                    spanNumber++;
                                }
                            }
                            var newCell = newRow.insertCell(-1);
                            newCell.setAttribute('rowSpan',spanNumber);
                            newCell.innerHTML=cellsList[i];
                        }
                    }
                    else
                    {
                        var newCell = newRow.insertCell(-1);
                        newCell.innerHTML = cellsList[i];
                    }
                }
            }
        }
    }
}

function BodyInit()
{
    InitUpdateView(InitTagValue());
    InitUpdateUSBAdvTableView(InitUpdateUSBAdvTableTagView());
}

// Nick Implement ASP Tag display on GUI

function showRemovalAlert()
{
    var cf=document.forms[0];
    if (cf.umountsucc.value == "1")
    {
         alert("Now you can remove this device.");
    }
    else if (cf.umountsucc.value == "2")
    {
        //openWarnWindow();
    }
}

//]]>
</script></head>
<body onload="loadSettings();changeContentSize();setTimeout('showRemovalAlert();', 250);" onResize="changeContentSize()" class="page-body">
    <img alt="" id="bodyBackgroundImg" src="img/subhead2-background.jpg" style="width:650px;height:445px;position: absolute;top:31px">
    <div id="full-page-container">
        <form id="target" name="frmService" method="post" action='/goform/USBAdvRetail?id=1102764329'>
            <input type="hidden" name="buttonHit">
            <input type="hidden" name="buttonValue">
            <div class="subhead2">
                USB Storage (Advanced Settings)
            </div>
            <table border="0" style="height:370px" class="subhead2-table">
                <tr align="left" valign="middle">
                    <td style="padding-top:10px;padding-bottom:10px" align="center" colspan="2" class="table-seperate-border">
                        &nbsp;&nbsp;&nbsp;
                        <button value="Apply" onclick="buttonClick(this,'Apply');checkData();" type="button" name="Apply" class="button-apply">
                            <span class="roundleft_apply">
                                Apply&nbsp;
                                <span class="apply-icon">
                                    &nbsp;&nbsp;&nbsp;&nbsp;
                                </span>
                            </span>
                            <span class="roundright_apply">
                                &nbsp;&nbsp;&nbsp;
                            </span>
                        </button>
                        &nbsp;&nbsp;&nbsp;
                        <button value="Cancel" onclick="buttonClick(this,'Refresh');location.href='USBAdvRetail.htm'" type="button" name="Refresh" class="button-rule">
                            <span class="roundleft_button">
                                <span class="refresh-icon">
                                    &nbsp;&nbsp;&nbsp;&nbsp; Refresh
                                </span>
                            </span>
                            <span class="roundright_button">
                                &nbsp;&nbsp;&nbsp;&nbsp;
                            </span>
                        </button>
                    </td>
                </tr>
                <tr>
                    <td class="scrollpane-table-seperate-border" colspan="2">
                        <div class="scroll-pane" style="height:365px;width:620px;overflow:auto;scrolling:auto">
                            <table style="border-collapse:collapse;width:600px">
                                <tr>
                                    <td colspan="2" style="height:12px">
                                        <div style="background-image:url('liteblue.gif');width:100%;background-repeat: repeat-x;">
                                            &nbsp;
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <table border="0" cellpadding="2" cellspacing="0" width="60%">
                                            <tr>
                                                <td>
                                                    <a href="javascript:loadhelp('USBAdv','device')"><b>Network/Device Name :</b></a>
                                                </td>
                                                <td style="width:30%">
                                                    <input type="text" name="deviceName" size="21" maxlength="15" value="readyshare">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="javascript:loadhelp('USBAdv','workgroup')"><b>Workgroup :</b></a>
                                                </td>
                                                <td style="width:30%">
                                                    <input type="text" name="workGroup" size="21" maxlength="15" value="Workgroup">
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <table border="1" cellpadding="2" cellspacing="0" width="60%">
                                            <tr>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <span class="thead">
                                                        Enable
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <span class="thead">
                                                        Access Method
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <span class="thead">
                                                        Link
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <span class="thead">
                                                        Port
                                                    </span>
                                                </td>
                                                <td align="center" nowrap="nowrap">
                                                    <span class="thead">
                                                        Admin Password<br> Protection
                                                    </span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_samba" value="enable_samba">
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    Network Neighborhood/MacShare
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <a id='smbId' target='_blank' style="text-decoration:underline;color:#0000ff"></a>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    -
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_samba_protect" value="enable_samba_protect" >
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_http" value="enable_http">
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    HTTP
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <a id='httpId' class="linktype" target="_blank" style="text-decoration:underline;color:#0000ff"></a>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    80
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_http_protect" value="enable_http_protect" >
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_wan_http" value="enable_wan_http">
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    HTTPS (via internet)
                                                </td>
                                                <!-- <td style="white-space: nowrap;text-align:center">HTTP (via internet)</td>
                                                -->
                                                <td style="white-space: nowrap;text-align:center">
                                                    <a id='httpsId' class="linktype" target="_blank" style="text-decoration:underline;color:#0000ff"></a>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="text" name="http_via_port" size="5" maxlength="5" value="443" style="text-align:center">
                                                </td>
                                                <td align="center" nowrap="nowrap">
                                                    <input type="checkbox" name="enable_wan_http_protect" value="enable_wan_http_protect" >
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_ftp" value="enable_ftp">
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    FTP
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <a id='ftpId' class="linktype" target="_blank" style="text-decoration:underline;color:#0000ff"></a>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    21
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_ftp_protect" value="enable_ftp_protect" >
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="checkbox" name="enable_wan_ftp" value="enable_wan_ftp">
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    FTP (via internet)
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <a id='ftpViaWan' class="linktype" target="_blank" style="text-decoration:underline;color:#0000ff"></a>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center">
                                                    <input type="text" name="ftp_via_port" size="5" maxlength="5" value="21" style="text-align:center">
                                                </td>
                                                <td align="center" nowrap="nowrap">
                                                    <input type="checkbox" name="enable_wan_ftp_protect" value="enable_wan_ftp_protect" >
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        Warning: We strongly recommend that you enable Admin Password Protection to secure your ReadySHARE data. If you did not change the default admin password, we also recommend that you change it to secure your network.
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="height:12px">
                                        <div style="background-image:url('liteblue.gif');width:100%;background-repeat: repeat-x;">
                                            &nbsp;
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <a href="javascript:loadhelp('USBAdv','available')"><b>Available Network Folders</b></a>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <table border="1" cellpadding="2" cellspacing="0" width="100%" id='AvailableFoldersTable' class="TableStyle">
                                            <tr>
                                                <td style="white-space: nowrap;text-align:center;width:5%">
                                                    <span class="thead">
                                                        &nbsp;
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center;widht:25%">
                                                    <span class="thead">
                                                        Share Name
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center;width:10%">
                                                    <span class="thead">
                                                        Read<BR>Access
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center;width:10%">
                                                    <span class="thead">
                                                        Write<BR>Access
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center;width:15%">
                                                    <span class="thead">
                                                        Folder Name
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center;width:15%">
                                                    <span class="thead">
                                                        Volume Name
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center;width:10%">
                                                    <span class="thead">
                                                        Total<BR>Space
                                                    </span>
                                                </td>
                                                <td style="white-space: nowrap;text-align:center;width:10%">
                                                    <span class="thead">
                                                        Free<BR>Space
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                        <input type="hidden" name="no_usb_device" value="1">
                                        <input type="hidden" name="sharefolderNum" value="0">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        &nbsp;&nbsp;&nbsp;
                                        <button type="button" value="Edit" name="Edit" class="button-rule" onclick="buttonClick(this,'Edit');edit_folder();">
                                            <span class="roundleft_button">
                                                <span class="edit-icon">
                                                    &nbsp;&nbsp;&nbsp;&nbsp; Edit
                                                </span>
                                            </span>
                                            <span class="roundright_button">
                                                &nbsp;&nbsp;&nbsp;&nbsp;
                                            </span>
                                        </button>
                                        &nbsp;&nbsp;&nbsp;
                                        <button type="button" value="Create Network Folder" name="Add" class="button-rule" onClick="buttonClick(this,'Create Network Folder');creat_folder();">
                                            <span class="roundleft_button">
                                                &nbsp;&nbsp; Create Network Folder
                                            </span>
                                            <span class="roundright_button">
                                                &nbsp;&nbsp;&nbsp;&nbsp;
                                            </span>
                                        </button>
                                        &nbsp;&nbsp;&nbsp;
                                        <button type="submit" value="Delete" name="Delete" class="button-rule" onclick="buttonClick(this,'Delete');return delete_folder();">
                                            <span class="roundleft_button">
                                                <span class="cancel-icon">
                                                    &nbsp;&nbsp;&nbsp;&nbsp; Delete
                                                </span>
                                            </span>
                                            <span class="roundright_button">
                                                &nbsp;&nbsp;&nbsp;&nbsp;
                                            </span>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="height:12px">
                                        <div style="background-image:url('liteblue.gif');width:100%;background-repeat: repeat-x;">
                                            &nbsp;
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        &nbsp;&nbsp;&nbsp;
                                        <button type="submit" value="Safely Remove USB Device" name="Remove" class="button-rule" onClick="buttonClick(this,'Safely Remove USB Device');return remove_disk();">
                                            <span class="roundleft_button">
                                                &nbsp;&nbsp; Safely Remove USB Device
                                            </span>
                                            <span class="roundright_button">
                                                &nbsp;&nbsp;&nbsp;&nbsp;
                                            </span>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="height:12px">
                                        <div style="background-image:url('liteblue.gif');width:100%;background-repeat: repeat-x;">
                                            &nbsp;
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr valign="middle" align="center">
                    <td class="table-seperate-border" colspan="2" style="padding-left:0px">
                        <div class="help-frame-div">
                            <iframe src="USBAdv_h.htm" class="help-iframe" scrolling="no" name="helpframe" frameborder="0">
                            </iframe>
                        </div>
                    </td>
                </tr>
            </table>
            <div class="subhead2-bottom">
                <span style="float:left;padding-left:10px;padding-top:5px">
                    <img alt="" src="img/help-icon.gif" onmouseover="changeCursorPointer();" onclick="showHelpIframe();" onmouseout="changeCursorDefault();">
                </span>
                <span class="subhead2-text" style="float:left;padding-left:3px;" onclick="showHelpIframe();" onmouseover="changeCursorPointer();" onmouseout="changeCursorDefault();">
                    Help Center
                </span>
                <span class="button-help-arrow">
                    <img alt="" src="img/helparrowdown-icon.gif" id="help-button" onclick="showHelpIframe();" onmouseover="changeCursorPointer();" onmouseout="changeCursorDefault();">
                </span>
                <span class="subhead2-text" style="text-decoration:underline;float:right;padding-right:10px" onclick="showHelpIframe();" onmouseover="changeCursorPointer();" onmouseout="changeCursorDefault();">
                    Show/Hide Help Center
                </span>
            </div>
            <input type="hidden" name="usb_num" value="0">
            <input type="hidden" name="select" value="-1">
            <input type="hidden" name="action" value="advance">
            <INPUT name=umountsucc type=hidden value="0">
            <input type="hidden" name="enable_apmode" value="0">
            <input type="hidden" name="is_https" value="1">
            <INPUT name=router_smb_link_style type=hidden value="others">
            <input name="no_dlna" type="hidden" value="">
            <input name="add_edit_page" type="hidden" value="0">
            <!-- Nick FolderIndex-->
            <input type="hidden" name="folderIdx" value="-1">
            <input type="hidden" name="UUID" value="-1">
            <!-- Nick FolderIndex-->
            <a name="helpframe-anchor"></a>
        </form>
    </div>
</body>
</html>
